<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Accessing Diagnostic Information in the Extended Events Log</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="a79e9468-2257-4536-91f1-73b008c376c3" /><meta name="Description" content="In the Microsoft JDBC Driver 4." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Accessing Diagnostic Information in the Extended Events Log</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><font color="DarkGray"><p>[This documentation is for preview only, and is subject to change in later releases. Blank topics are included as placeholders.]</p></font><div class="introduction"><p>In the Microsoft JDBC Driver 4.0 for SQL Server, tracing (<span sdata="link"><a href="723aeae7-6504-4585-ba8b-3525115bea8b.htm">Tracing Driver Operation</a></span>) has been updated to make it easier to easier to correlate client events with diagnostic information, such as connection failures, from the server's connectivity ring buffer and application performance information in the extended events log.</p></div><h1 class="heading">Details</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>For connection operations, the Microsoft JDBC Driver for SQL Server will send a client connection ID. If the connection fails, you can access the connectivity ring buffer (<a href="http://go.microsoft.com/fwlink/?LinkId=207752">Connectivity troubleshooting in SQL Server 2008 with the Connectivity Ring Buffer</a>) and find the <span sdata="langKeyword" value="ClientConnectionID"><span class="keyword">ClientConnectionID</span></span> field and get diagnostic information about the connection failure. Client connection IDs are logged in the ring buffer only if an error occurs. (If a connection fails before sending the prelogin packet, a client connection ID will not be generated.) The client connection ID is a 16-byte GUID. You can also find the client connection ID in the extended events target output, if the <span sdata="langKeyword" value="client_connection_id"><span class="keyword">client_connection_id</span></span> action is added to events in an extended events session. You can enable tracing and rerun the connection command and observe the <span sdata="langKeyword" value="ClientConnectionID"><span class="keyword">ClientConnectionID</span></span> field in the trace, if you need further client driver diagnostic assistance.</p><p>You can get the client connection ID programmatically by using <span sdata="link"><a href="031c01e2-2c65-4fe4-9700-fdbcc7a39f30.htm">ISQLServerConnection Interface</a></span>. The connection ID will also be present in any connection-related exceptions.</p><p>When there is a connection error, the client connection ID in the server's BID trace information and in the connectivity ring buffer can help correlate the client connections to connections on the server. For more information about BID traces on the server, see <a href="http://go.microsoft.com/fwlink/?LinkId=125805">Data Access Tracing</a>. Note, the data access tracing article also contains information about performing a data access trace, which does not apply to the Microsoft JDBC Driver for SQL Server; see <span sdata="link"><a href="723aeae7-6504-4585-ba8b-3525115bea8b.htm">Tracing Driver Operation</a></span> for information on doing a data access trace using the Microsoft JDBC Driver for SQL Server.</p><p>The following is a sample that uses Transact-SQL to start an extended events session that will be stored in a ring buffer.</p><div class="sampleCode"><span codeLanguage="other"><pre>create event session MySession on server 
add event connectivity_ring_buffer_recorded, 
add event sql_statement_starting (action (client_connection_id)), 
add event sql_statement_completed (action (client_connection_id)), 
add event rpc_starting (action (client_connection_id)), 
add event rpc_completed (action (client_connection_id))
add target ring_buffer with (track_causality=on)</pre></span></div></div><span id="seeAlsoSpan"><h1 class="heading">See Also</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="723e2680-a0c5-4a7d-a319-1e49e41078cf.htm">Diagnosing Problems with the JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">
			Send
		<a href="javascript:SubmitFeedback('sqldocfb@microsoft.com','JDBC','JDBC','','01.00.11191.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/en-us/default.aspx.%0\A%0\d','Customer%20Feedback');">
			
      feedback
		</a>
			on this topic to Microsoft.
		</span><span id="copyrightarea"><p>
      Â© 2011 Microsoft Corporation. All rights reserved.
      </p></span></div></div></body></html>